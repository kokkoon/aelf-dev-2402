"use strict";(self.webpackChunkaelf_dev_2402=self.webpackChunkaelf_dev_2402||[]).push([[5690],{196:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var o=n(4848),a=n(8453);const r={sidebar_position:3},i="View Methods",s={id:"additional/more-about-contract/5.3 view-methods",title:"View Methods",description:"By default, States defined in the contract cannot be accessed through external sources unless the contract developer implements a view method specifically designed to expose the value of a State.",source:"@site/docs/5. additional/more-about-contract/5.3 view-methods.md",sourceDirName:"5. additional/more-about-contract",slug:"/additional/more-about-contract/5.3 view-methods",permalink:"/aelf-dev-2402/docs/additional/more-about-contract/5.3 view-methods",draft:!1,unlisted:!1,editUrl:"https://github.com/kokkoon/aelf-dev-2402/tree/main/docs/5. additional/more-about-contract/5.3 view-methods.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Context",permalink:"/aelf-dev-2402/docs/additional/more-about-contract/5.2 context"},next:{title:"Inline Contract Call",permalink:"/aelf-dev-2402/docs/additional/more-about-contract/5.4 inline-contract-call"}},d={},l=[];function c(e){const t={admonition:"admonition",code:"code",h1:"h1",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"view-methods",children:"View Methods"}),"\n",(0,o.jsx)(t.p,{children:"By default, States defined in the contract cannot be accessed through external sources unless the contract developer implements a view method specifically designed to expose the value of a State."}),"\n",(0,o.jsxs)(t.p,{children:["To define a ",(0,o.jsx)(t.strong,{children:"view"})," method in the proto file of the contract, you need to add ",(0,o.jsx)(t.code,{children:"option (aelf.is_view) = true;"})," to the rpc method."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-protobuf",children:"rpc Read (google.protobuf.Empty) returns (google.protobuf.StringValue) {\n  option (aelf.is_view) = true;\n}\n"})}),"\n",(0,o.jsxs)(t.h1,{id:"read-method",children:[(0,o.jsx)(t.code,{children:"Read"})," method"]}),"\n",(0,o.jsxs)(t.p,{children:["The Read method aims to expose the value of ",(0,o.jsx)(t.code,{children:"State.Message.Value"})," is actually very straightforward to implement."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-csharp",children:"// A method that read the contract state\npublic override StringValue Read(Empty input)\n{\n    // Retrieve the value from the state\n    var value = State.Message.Value;\n    // Wrap the value in the return type\n    return new StringValue\n    {\n        Value = value\n    };\n}\n"})}),"\n",(0,o.jsxs)(t.h1,{id:"readmessage-method",children:[(0,o.jsx)(t.code,{children:"ReadMessage"})," method"]}),"\n",(0,o.jsxs)(t.p,{children:["You can define another method to expose the value of the mapped state ",(0,o.jsx)(t.code,{children:"State.Messages"}),"."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-protobuf",children:"rpc ReadMessage (google.protobuf.Int32Value) returns (google.protobuf.StringValue) {\n  option (aelf.is_view) = true;\n}\n"})}),"\n",(0,o.jsx)(t.p,{children:"And the implementation can be:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-csharp",children:"public override StringValue ReadMessage(Int32Value input)\n{\n    return new StringValue\n    {\n        Value = State.Messages[input.Value]\n    };\n}\n"})}),"\n",(0,o.jsxs)(t.admonition,{type:"tip",children:[(0,o.jsx)(t.p,{children:"It is worth noting that when you call any View method, its return value will not be null. If the state does not exist and the return value is of type StringValue, the return value will be a:"}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-csharp",children:'new StringValue()\n{\n    Value = ""\n};\n'})})]})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var o=n(6540);const a={},r=o.createContext(a);function i(e){const t=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),o.createElement(r.Provider,{value:t},e.children)}}}]);